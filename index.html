<div id="lightningLocator"></div>

<script>
    const loadSFScriptTimeout = setTimeout(loadSFScript, 1000);

    function loadSFScript() {
        clearTimeout(loadSFScriptTimeout);
        const src = "https://dohertyclinicaltrials--uat.sandbox.my.salesforce-sites.com/lightning/lightning.out.js";
        const sfs = document.createElement("script");
        sfs.src = src;
        document.body.appendChild(sfs);
    }
</script>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const flowName = "SF_Recruitment_Forms";

    if (flowName) {
        const loadSFFormTimeout = setTimeout(loadSFForm, 5000);
        function loadSFForm() {
            clearTimeout(loadSFFormTimeout);

            $Lightning.use("c:GenericEmbedFlowInExternalWebsitesApp", function () {
                const parameters = "flowName=" + flowName;

                $Lightning.createComponent(
                    "c:GenericEmbedFlowInExternalWebsites",
                    { "parameters": parameters },
                    "lightningLocator",
                    function (cmp) { }
                );
            },
            'https://dohertyclinicaltrials--uat.sandbox.my.site.com/TestSite', 
            'authToken');
        }
    }
</script>
